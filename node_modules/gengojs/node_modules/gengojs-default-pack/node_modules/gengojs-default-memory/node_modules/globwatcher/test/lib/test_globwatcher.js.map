{"version":3,"sources":["../src/test_globwatcher.js"],"names":[],"mappings":"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","file":"test/src/test_globwatcher.js","sourcesContent":["let fs = require(\"fs\");\nlet globwatcher = require(\"../../lib/globwatcher/globwatcher\");\nlet minimatch = require(\"minimatch\");\nlet mocha_sprinkles = require(\"mocha-sprinkles\");\nlet path = require(\"path\");\nlet Promise = require(\"bluebird\");\nlet shell = require(\"shelljs\");\nlet should = require(\"should\");\nlet touch = require(\"touch\");\nlet util = require(\"util\");\n\nlet future = mocha_sprinkles.future;\nlet withTempFolder = mocha_sprinkles.withTempFolder;\n\nrequire(\"source-map-support\").install();\n\nfunction makeFixtures(folder, ts) {\n  if (!ts) ts = Date.now() - 1000;\n  [\n    `${folder}/one.x`,\n    `${folder}/sub/one.x`,\n    `${folder}/sub/two.x`,\n    `${folder}/nested/three.x`,\n    `${folder}/nested/weird.jpg`\n  ].map((file) => {\n    shell.mkdir(\"-p\", path.dirname(file));\n    touch.sync(file, { mtime: ts });\n  });\n}\n\nfunction fixtures(f) {\n  return future(withTempFolder((folder) => {\n    makeFixtures(folder);\n    return f(folder);\n  }));\n}\n\n// create a new globwatch, run a test, and close it\nfunction withGlobwatcher(pattern, options, f) {\n  if (f == null) {\n    f = options;\n    options = {};\n  }\n  options.persistent = false;\n  let g = globwatcher.globwatcher(pattern, options);\n  return g.ready.finally(() => f(g)).finally(() => g.close());\n}\n\n// capture add/remove/change into an object for later inspection\nfunction capture(g) {\n  let summary = {};\n\n  function push(name, item) {\n    if (summary[name] == null) summary[name] = [];\n    summary[name].push(item);\n    summary[name].sort();\n  }\n\n  g.on(\"added\", (filename) => push(\"added\", filename));\n  g.on(\"deleted\", (filename) => push(\"deleted\", filename));\n  g.on(\"changed\", (filename) => push(\"changed\", filename));\n  return summary;\n}\n\ndescribe(\"globwatcher\", () => {\n  it(\"folderMatchesMinimatchPrefix\", () => {\n    let set = new minimatch.Minimatch(\"/home/commie/**/*.js\", { nonegate: true }).set[0];\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\" ], set).should.equal(true);\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\", \"commie\" ], set).should.equal(true);\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\", \"robey\" ], set).should.equal(false);\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\", \"commie\", \"rus\" ], set).should.equal(true);\n    set = new minimatch.Minimatch(\"/home/commie/l*/*.js\", { nonegate: true }).set[0];\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\" ], set).should.equal(true);\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\", \"commie\" ], set).should.equal(true);\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\", \"robey\" ], set).should.equal(false);\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\", \"commie\", \"rus\" ], set).should.equal(false);\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\", \"commie\", \"lola\" ], set).should.equal(true);\n    globwatcher.folderMatchesMinimatchPrefix([ \"\", \"home\", \"commie\", \"lola\", \"prissy\" ], set).should.equal(false);\n  });\n\n  it(\"addWatch\", future(() => {\n    return withGlobwatcher(\"/~~nonexistent~~\", (g) => {\n      [\n        \"/absolute.txt\",\n        \"/sub/absolute.txt\",\n        \"/deeply/nested/file/why/nobody/knows.txt\"\n      ].forEach((f) => g.addWatch(f));\n      g.watchMap.getFolders().sort().should.eql([ \"/\", \"/deeply/nested/file/why/nobody/\", \"/sub/\" ]);\n      g.watchMap.getFilenames(\"/\").should.eql([ \"/absolute.txt\" ]);\n      g.watchMap.getFilenames(\"/sub/\").should.eql([ \"/sub/absolute.txt\" ]);\n      g.watchMap.getFilenames(\"/deeply/nested/file/why/nobody/\").should.eql([ \"/deeply/nested/file/why/nobody/knows.txt\" ]);\n    });\n  }));\n\n  it(\"can parse patterns\", fixtures((folder) => {\n    return withGlobwatcher(`${folder}/**/*.x`, (g) => {\n      g.patterns.should.eql([ `${folder}/**/*.x` ]);\n      Object.keys(g.watchers).sort().should.eql([ `${folder}/`, `${folder}/nested/`, `${folder}/sub/` ]);\n      g.watchMap.getFolders().sort().should.eql([ `${folder}/`, `${folder}/nested/`, `${folder}/sub/` ]);\n      g.watchMap.getFilenames(`${folder}/`).should.eql([ `${folder}/one.x` ]);\n      g.watchMap.getFilenames(`${folder}/nested/`).should.eql([ `${folder}/nested/three.x` ]);\n      g.watchMap.getFilenames(`${folder}/sub/`).should.eql([ `${folder}/sub/one.x`, `${folder}/sub/two.x` ]);\n    });\n  }));\n\n  it(\"can parse patterns relative to cwd\", fixtures((folder) => {\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}/sub` }, (g) => {\n      g.patterns.should.eql([ `${folder}/sub/**/*.x` ]);\n      Object.keys(g.watchers).sort().should.eql([ `${folder}/sub/` ]);\n      g.watchMap.getFolders().sort().should.eql([ `${folder}/sub/` ]);\n      g.watchMap.getFilenames(`${folder}/sub/`).should.eql([ `${folder}/sub/one.x`, `${folder}/sub/two.x` ]);\n    });\n  }));\n\n  it(\"handles odd relative paths\", fixtures((folder) => {\n    return withGlobwatcher(\"../sub/**/*.x\", { cwd: `${folder}/nested` }, (g) => {\n      Object.keys(g.watchers).sort().should.eql([ `${folder}/sub/` ]);\n      g.watchMap.getFolders().sort().should.eql([ `${folder}/sub/` ]);\n      g.watchMap.getFilenames(`${folder}/sub/`).should.eql([ `${folder}/sub/one.x`, `${folder}/sub/two.x` ]);\n    });\n  }));\n\n  it(\"notices new files\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(`${folder}/**/*.x`, (g) => {\n      summary = capture(g);\n      touch.sync(`${folder}/nested/four.x`);\n      touch.sync(`${folder}/sub/not-me.txt`);\n      return g.check().then(() => {\n        summary.should.eql({\n          added: [ `${folder}/nested/four.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"doesn't emit signals when turned off\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(`${folder}/**/*.x`, (g) => {\n      summary = capture(g);\n      g.stopWatches();\n      return Promise.delay(50).then(() => {\n        touch.sync(`${folder}/nested/four.x`);\n        touch.sync(`${folder}/sub/not-me.txt`);\n        g.check();\n      }).then(() => {\n        // just in case, make sure the timer goes off too\n        return Promise.delay(g.interval * 2);\n      }).then(() => {\n        summary.should.eql({});\n      });\n    });\n  }));\n\n  it(\"notices new files only in cwd\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}/sub` }, (g) => {\n      summary = capture(g);\n      touch.sync(`${folder}/nested/four.x`);\n      touch.sync(`${folder}/sub/not-me.txt`);\n      touch.sync(`${folder}/sub/four.x`);\n      return g.check().then(() => {\n        summary.should.eql({\n          added: [ `${folder}/sub/four.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"notices new files nested deeply\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(`${folder}/**/*.x`, (g) => {\n      summary = capture(g);\n      shell.mkdir(\"-p\", `${folder}/nested/more/deeply`);\n      touch.sync(`${folder}/nested/more/deeply/nine.x`);\n      return g.check().then(() => {\n        summary.should.eql({\n          added: [ `${folder}/nested/more/deeply/nine.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"notices deleted files\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}` }, (g) => {\n      summary = capture(g);\n      fs.unlinkSync(`${folder}/sub/one.x`);\n      return g.check().then(() => {\n        summary.should.eql({\n          deleted: [ `${folder}/sub/one.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"notices a rename as an add + delete\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}` }, (g) => {\n      summary = capture(g);\n      fs.renameSync(`${folder}/sub/two.x`, `${folder}/sub/twelve.x`);\n      return g.check().then(() => {\n        summary.should.eql({\n          added: [ `${folder}/sub/twelve.x` ],\n          deleted: [ `${folder}/sub/two.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"handles a nested delete\", fixtures((folder) => {\n    shell.mkdir(\"-p\", `${folder}/nested/more/deeply`);\n    touch.sync(`${folder}/nested/more/deeply/here.x`);\n    let summary = null;\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}` }, (g) => {\n      summary = capture(g);\n      shell.rm(\"-r\", `${folder}/nested`);\n      return g.check().then(() => {\n        summary.should.eql({\n          deleted: [ `${folder}/nested/more/deeply/here.x`, `${folder}/nested/three.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"handles a changed file\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}` }, (g) => {\n      summary = capture(g);\n      fs.writeFileSync(`${folder}/sub/one.x`, \"gahhhhhh\");\n      return g.check().then(() => {\n        summary.should.eql({\n          changed: [ `${folder}/sub/one.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"follows a safe-write\", fixtures((folder) => {\n    let summary = null;\n    let savee = `${folder}/one.x`;\n    let backup = `${folder}/one.x~`;\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}` }, (g) => {\n      summary = capture(g);\n      fs.writeFileSync(backup, fs.readFileSync(savee));\n      fs.unlinkSync(savee);\n      fs.renameSync(backup, savee);\n      return g.check().then(() => {\n        summary.should.eql({\n          changed: [ savee ]\n        });\n      });\n    });\n  }));\n\n  it(\"only emits once for a changed file\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}` }, (g) => {\n      summary = capture(g);\n      fs.writeFileSync(`${folder}/one.x`, \"whee1\");\n      return g.check().then(() => {\n        summary.should.eql({\n          changed: [ `${folder}/one.x` ]\n        });\n        return g.check();\n      }).then(() => {\n        summary.should.eql({\n          changed: [ `${folder}/one.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"emits twice if a file was changed twice\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(\"**/*.x\", { cwd: `${folder}` }, (g) => {\n      summary = capture(g);\n      fs.writeFileSync(`${folder}/one.x`, \"whee1\");\n      return g.check().then(() => {\n        summary.should.eql({\n          changed: [ `${folder}/one.x` ]\n        });\n        fs.writeFileSync(`${folder}/one.x`, \"whee123\");\n        return g.check();\n      }).then(() => {\n        summary.should.eql({\n          changed: [ `${folder}/one.x`, `${folder}/one.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"doesn't mind watching a nonexistent folder\", fixtures((folder) => {\n    return withGlobwatcher(`${folder}/not/there/*`, (g) => {\n      (3).should.equal(3);\n    });\n  }));\n\n  it(\"sees a new matching file even if the whole folder was missing when it started\", future(withTempFolder((folder) => {\n    let summary = null;\n    return withGlobwatcher(`${folder}/not/there/*`, (g) => {\n      summary = capture(g);\n      shell.mkdir(\"-p\", `${folder}/not/there`);\n      fs.writeFileSync(`${folder}/not/there/ten.x`, \"wheeeeeee\");\n      return g.check().then(() => {\n        summary.should.eql({\n          added: [ `${folder}/not/there/ten.x` ]\n        });\n      });\n    });\n  })));\n\n  it(\"sees a new matching file even if nested folders were missing when it started\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(`${folder}/sub/deeper/*.x`, (g) => {\n      summary = capture(g);\n      shell.mkdir(\"-p\", `${folder}/sub/deeper`);\n      fs.writeFileSync(`${folder}/sub/deeper/ten.x`, \"wheeeeeee\");\n      return g.check().then(() => {\n        summary.should.eql({\n          added: [ `${folder}/sub/deeper/ten.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"sees a new matching file even if the entire tree was erased and re-created\", fixtures((folder) => {\n    shell.rm(\"-rf\", `${folder}/nested`);\n    shell.mkdir(\"-p\", `${folder}/nested/deeper/still`);\n    touch.sync(`${folder}/nested/deeper/still/four.x`);\n    let summary = null;\n    return withGlobwatcher(`${folder}/**/*`, (g) => {\n      summary = capture(g);\n      shell.rm(\"-r\", `${folder}/nested`);\n      return g.check().then(() => {\n        summary.should.eql({\n          deleted: [ `${folder}/nested/deeper/still/four.x` ]\n        });\n        delete summary.deleted;\n        shell.mkdir(\"-p\", `${folder}/nested/deeper/still`);\n        fs.writeFileSync(`${folder}/nested/deeper/still/ten.x`, \"wheeeeeee\");\n        return g.check();\n      }).then(() => {\n        summary.should.eql({\n          added: [ `${folder}/nested/deeper/still/ten.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"sees a new matching file even if the folder exists but was empty\", fixtures((folder) => {\n    shell.mkdir(\"-p\", `${folder}/nested/deeper`);\n    let summary = null;\n    return withGlobwatcher(`${folder}/nested/deeper/*.x`, (g) => {\n      summary = capture(g);\n      fs.writeFileSync(`${folder}/nested/deeper/ten.x`, \"wheeeeeee\");\n      return g.check().then(() => {\n        summary.should.eql({\n          added: [ `${folder}/nested/deeper/ten.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"emits signals for folders when asked\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(`${folder}/**/*`, { emitFolders: true }, (g) => {\n      summary = capture(g);\n      shell.mkdir(\"-p\", `${folder}/newfolder`);\n      shell.rm(\"-r\", `${folder}/nested`);\n      return g.check().then(() => {\n        summary.should.eql({\n          added: [ `${folder}/newfolder/` ],\n          deleted: [ `${folder}/nested/`, `${folder}/nested/three.x`, `${folder}/nested/weird.jpg` ]\n        });\n      });\n    });\n  }));\n\n  it(\"will watch a single, non-globbed file that doesn't exist\", fixtures((folder) => {\n    let summary = null;\n    return withGlobwatcher(`${folder}/nothing.x`, (g) => {\n      summary = capture(g);\n      fs.writeFileSync(`${folder}/nothing.x`, \"hi!\");\n      return Promise.delay(g.interval).then(() => {\n        summary.should.eql({\n          added: [ `${folder}/nothing.x` ]\n        });\n      });\n    });\n  }));\n\n  it(\"returns a currentSet\", fixtures((folder) => {\n    return withGlobwatcher(`${folder}/**/*.x`, (g) => {\n      g.currentSet().sort().should.eql([\n        `${folder}/nested/three.x`,\n        `${folder}/one.x`,\n        `${folder}/sub/one.x`,\n        `${folder}/sub/two.x`\n      ]);\n      shell.rm(`${folder}/sub/one.x`);\n      fs.writeFileSync(`${folder}/whatevs.x`);\n      return g.check().then(() => {\n        g.currentSet().sort().should.eql([\n          `${folder}/nested/three.x`,\n          `${folder}/one.x`,\n          `${folder}/sub/two.x`,\n          `${folder}/whatevs.x`\n        ]);\n      });\n    });\n  }));\n\n  describe(\"takes a snapshot\", () => {\n    it(\"of globs\", fixtures((folder) => {\n      return withGlobwatcher(`${folder}/**/*.x`, { snapshot: {} }, (g) => {\n        let ts = fs.statSync(`${folder}/one.x`).mtime.getTime();\n        fs.writeFileSync(`${folder}/wut.x`, \"hello\");\n        touch.sync(`${folder}/wut.x`, { mtime: ts });\n        return g.check().then(() => {\n          let snapshot = g.snapshot();\n          snapshot[`${folder}/one.x`].should.eql({ mtime: ts, size: 0 });\n          snapshot[`${folder}/wut.x`].should.eql({ mtime: ts, size: 5 });\n          snapshot[`${folder}/nested/three.x`].should.eql({ mtime: ts, size: 0 });\n          snapshot[`${folder}/sub/one.x`].should.eql({ mtime: ts, size: 0 });\n          snapshot[`${folder}/sub/two.x`].should.eql({ mtime: ts, size: 0 });\n        });\n      });\n    }));\n\n    it(\"of normal files\", fixtures((folder) => {\n      return withGlobwatcher(`${folder}/sub/two.x`, { snapshot: {} }, (g) => {\n        let ts = fs.statSync(`${folder}/sub/two.x`).mtime.getTime();\n        return g.check().then(() => {\n          let snapshot = g.snapshot();\n          snapshot[`${folder}/sub/two.x`].should.eql({ mtime: ts, size: 0 });\n          fs.writeFileSync(`${folder}/sub/two.x`, \"new!\");\n          ts = fs.statSync(`${folder}/sub/two.x`).mtime.getTime();\n          return withGlobwatcher(`${folder}/sub/two.x`, { snapshot }, (g) => {\n            return g.check().then(() => {\n              snapshot = g.snapshot();\n              snapshot[`${folder}/sub/two.x`].should.eql({ mtime: ts, size: 4 });\n            });\n          });\n        });\n      });\n    }));\n  });\n\n  it(\"resumes from a snapshot\", fixtures((folder) => {\n    return withGlobwatcher(`${folder}/**/*.x`, (g) => {\n      let summary = null;\n      let snapshot = g.snapshot();\n      g.close();\n      return Promise.delay(100).then(() => {\n        fs.writeFileSync(`${folder}/one.x`, \"hello\");\n        shell.rm(`${folder}/sub/two.x`);\n        touch.sync(`${folder}/sub/nine.x`);\n        g = globwatcher.globwatcher(`${folder}/**/*.x`, { persistent: false, snapshot: snapshot });\n        summary = capture(g);\n        return g.ready;\n      }).then(() => {\n        summary.should.eql({\n          added: [ `${folder}/sub/nine.x` ],\n          changed: [ `${folder}/one.x` ],\n          deleted: [ `${folder}/sub/two.x` ]\n        });\n      });\n    });\n  }));\n});\n"]}